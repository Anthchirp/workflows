dist: trusty

language: python

matrix:
  include:
    - python: 2.7
    - python: 3.4
    - python: 3.5
    - python: 3.6
    - python: 3.7
      dist: xenial
      sudo: true

before_install:
  - ./.travis-update-setuptools
install:
  - pip install .
  - pip install 'pytest>=3.6' pytest-cov pytest-timeout coveralls
script:
  - py.test --cov=workflows
after_success:
  - coveralls

# Assuming you have installed the travis-ci CLI tool, after you
# create the Github repo and add it to Travis, run the
# following command to finish PyPI deployment setup:
# $ travis encrypt --add deploy.password
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: mgerstel
  password:
    secure: NULlNoAVRpUzqYJhs1g/P57Y98bcXsntxhv7KlGXKsVEIlcP14bzlirh3+kWVsyu197/PX6spHjWi6BQHzIDKPXoI1bCwMApLE+7Z4gZYp6lZ0zI86B0WQoYc3r1Dzth8mBl6Uy2sGG1SaPqbC8CxAdGKOt/fnP9PCJWmkHZzB0WGID5NIjZLaGiciZ7pHugrwg6MeAX/F71oSXNN4RpH1owZWeyesEdc+3SKuSltynHqinL5mcP3xLyzBs8JlUL89GTnEATrqIEBMLU7NXzdoFZjdgYyTpuT6xp7Q2/iHNUa6j9oXVJcxDMJuuPuRcTw0GiU0chtUB/+IFBXbVv8SpKotoaflm1kjqGjlFn2YzeZLJS4hcGMUSYXxvFX1kr92o7cRTVKwkknkJE52gU2bug6DRMYUgs7C+Dty2scEAKudB0DC0KJrJ5S5g9886NGkAQ8UW6UmhhbFr+4p7xQjYQ/cqcULdgwBPOfR///eu78DwfrtUl98/lsWQDwjrue5o7iTQsFx0Tkf3AC7nCKX2vpKG8aHWrfMXRjiVclttwV4DidUX88GQEHSIqTRhOZfgAjN80nQHueCoCQYIv/WC5UXU5R+BAi5aGJaKRgXOGG5qZXncCaSNtPytBC5/IDbfWIgIOMzG7H3FVsOw5XusiURraon6dxOIbOl9pEZg=
  on:
    tags: true
    repo: DiamondLightSource/python-workflows
    python: 3.7
